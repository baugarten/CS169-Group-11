=content_for :title do "Donation" end
.row-fluid.box-unit
  .span6#picture-donate
    = render 'picture'
  .span6
    %h1.title.row-fluid
      = @project.farmer
    .row-fluid.description
      -if @project.description.length > 250
        = "#{@project.description[1..250]}..."
      -else
        = @project.description
    .row-fluid
      %h3 
        $#{@project.current.to_i} donated of #{@project.target.to_i} goal
      .progress.progress-strive.active
        - width = 100 - (@project.target - @project.current) * 100 / @project.target
        .bar{:style => "width: #{width}%;"}
.row-fluid#stripe-section
  .row-fluid
    %h2
      Donate:
  .row-fluid
    = form_for :donation, :url => charge_project_path(@project) do |form|
      .row
        .span3
          Donation amount:
        .span3
          = text_field :donation, :readable_amount, :readonly=>:true
        .span1
          = link_to "Edit", project_path(@project), :class => "btn btn-warning"
      .row
        .span3
          Email (optional):
        .span3
          = text_field :donation, :email
      .row
        .span3
          Donate by credit card through Stripe
        .span3
          <script src="https://button.stripe.com/v1/button.js" class="stripe-button"
          data-key="#{Rails.configuration.stripe[:publishable_key]}"
          data-description="Donation to #{@project.farmer}"
          data-label="Donate"
          data-amount="#{@donation.amount}"></script>
